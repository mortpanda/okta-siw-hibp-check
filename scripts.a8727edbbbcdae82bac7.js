var strResponse,arrLines,strMatchedPW;function OktaWidget(){const e=new OktaSignIn({language:"ja",colors:{brand:"#00297A"},i18n:{en:{"primaryauth.title":"Log In","primaryauth.submit":"Log In"}},features:{registration:!0,rememberMe:!1},baseUrl:"https://csm-apac.oktapreview.com",redirectUri:"https://mortpanda.github.io/okta-siw-hibp-check/",clientId:"aaa0oa17rxjm2Fgi4yT31d7",authParams:{issuer:"https://csm-apac.oktapreview.comoauth2/default",issuer:"default",responseType:["token","id_token"],responseMode:"fragment",display:"page",scope:["openid","email","profile"]},registration:{parseSchema:function(e,t,n){console.log(e.profileSchema),t(e)},preSubmit:function(e,t,n){const r=document.getElementById("console");document.getElementById("console").innerHTML=" ",document.getElementById("console").innerHTML="<br> <br> <h1 style='padding: 15px'>CHECKING HIBP.......",document.getElementsByName("email"),document.getElementsByName("firstName"),document.getElementsByName("lastName");var o=SHA1(document.getElementsByName("password")[0].value),s=o.substring(0,5),a=o.substring(5,999),c=new XMLHttpRequest;c.responseType="text",c.onreadystatechange=function(){if(4==this.readyState&&200==this.status){for(hbipres=this.responseText,lines=hbipres.split("\n"),document.getElementById("console").innerHTML=" ",i=0;i<lines.length;i++){document.getElementById("console").innerHTML+="<font color=white>&nbsp&nbsp"+lines[i]+"<br>";var e=(arrLines=lines[i].split(":"))[0].toUpperCase(),t=a.toUpperCase();r.scrollTop=r.scrollHeight,t==e&&(strMatchedPW=arrLines[1],document.getElementById("console").innerHTML+="<font color=red>&nbsp&nbsp"+lines[i]+"<br>")}document.getElementById("console").innerHTML+="&nbsp&nbsp<br><br><br><br><h1 style='padding: 15px'>  Match found! The password entered has been comprimised <font color=red>"+strMatchedPW+"<font color=white> times according to HIBP</h1>",document.getElementById("console").innerHTML+="&nbsp&nbsp<br><br><br><br><h1 style='padding: 15px'>  Hashed password used to check against HIBP is <font color=red>"+t+"<font color=white></h2>",r.scrollTop=r.scrollHeight}},c.open("GET","https://api.pwnedpasswords.com/range/"+s,!0),c.send()},postSubmit:function(e,t,n){t(e)}}});e.on("afterRender",function(e){if(console.log(e.controller),"registration"==e.controller){var t=document.getElementsByName("firstName")[0],n=document.getElementsByName("lastName")[0],r=document.getElementsByName("email")[0],o=document.getElementsByName("password")[0],s=document.getElementsByName("acceptedPrivacyPolicy")[0],a=o.parentNode.parentNode.parentNode,i=t.parentNode.parentNode.parentNode,c=n.parentNode.parentNode.parentNode,d=r.parentNode.parentNode.parentNode;s.parentNode.parentNode.parentNode.style.display="none",$(c).insertAfter(i),$(d).insertAfter(c),$(a).insertAfter(d),$("subschemas-password").insertAfter(a)}}),e.token.hasTokensInUrl()||e.session.get(function(t){"ACTIVE"!==t.status&&e.renderEl({el:"#okta-signin-container"},function(e){console.error(e)})})}function SHA1(e){function t(e,t){return e<<t|e>>>32-t}function n(e){var t,n="";for(t=7;t>=0;t--)n+=(e>>>4*t&15).toString(16);return n}var r,o,s,a,i,c,d,l,p,m=new Array(80),h=1732584193,u=4023233417,g=2562383102,f=271733878,b=3285377520,y=(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}(e)).length,C=new Array;for(o=0;o<y-3;o+=4)s=e.charCodeAt(o)<<24|e.charCodeAt(o+1)<<16|e.charCodeAt(o+2)<<8|e.charCodeAt(o+3),C.push(s);switch(y%4){case 0:o=2147483648;break;case 1:o=e.charCodeAt(y-1)<<24|8388608;break;case 2:o=e.charCodeAt(y-2)<<24|e.charCodeAt(y-1)<<16|32768;break;case 3:o=e.charCodeAt(y-3)<<24|e.charCodeAt(y-2)<<16|e.charCodeAt(y-1)<<8|128}for(C.push(o);C.length%16!=14;)C.push(0);for(C.push(y>>>29),C.push(y<<3&4294967295),r=0;r<C.length;r+=16){for(o=0;o<16;o++)m[o]=C[r+o];for(o=16;o<=79;o++)m[o]=t(m[o-3]^m[o-8]^m[o-14]^m[o-16],1);for(a=h,i=u,c=g,d=f,l=b,o=0;o<=19;o++)p=t(a,5)+(i&c|~i&d)+l+m[o]+1518500249&4294967295,l=d,d=c,c=t(i,30),i=a,a=p;for(o=20;o<=39;o++)p=t(a,5)+(i^c^d)+l+m[o]+1859775393&4294967295,l=d,d=c,c=t(i,30),i=a,a=p;for(o=40;o<=59;o++)p=t(a,5)+(i&c|i&d|c&d)+l+m[o]+2400959708&4294967295,l=d,d=c,c=t(i,30),i=a,a=p;for(o=60;o<=79;o++)p=t(a,5)+(i^c^d)+l+m[o]+3395469782&4294967295,l=d,d=c,c=t(i,30),i=a,a=p;h=h+a&4294967295,u=u+i&4294967295,g=g+c&4294967295,f=f+d&4294967295,b=b+l&4294967295}return(p=n(h)+n(u)+n(g)+n(f)+n(b)).toLowerCase()}